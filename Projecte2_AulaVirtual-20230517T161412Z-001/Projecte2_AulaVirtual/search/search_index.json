{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Projecte 2 - Aula Virtual Marc Sanchez Cusc\u00f3 - Albert D\u00edaz Montan\u00e9","title":"Home"},{"location":"#projecte-2-aula-virtual","text":"","title":"Projecte 2 - Aula Virtual"},{"location":"#marc-sanchez-cusco-albert-diaz-montane","text":"","title":"Marc Sanchez Cusc\u00f3 - Albert D\u00edaz Montan\u00e9"},{"location":"avirtual/","text":"Instal\u00b7laci\u00f3 de l\u2019aula virtual i els contenidors corresponents Per instal\u00b7lar el moodle, \u00e9s necessari comptar amb una base de dades, i tamb\u00e9, per agilitzar l\u2019administraci\u00f3, un entorn gr\u00e0fic de gesti\u00f3 com PhpMyAdmin. El programari requerit l\u2019instal\u00b7larem en contenidors mitjan\u00e7ant Docker. Cada component (Moodle, MariaDB i PhpMyAdmin) anir\u00e0 dins d\u2019un contenidor diferent. Perqu\u00e8 els contenidors es puguin comunicar entre ells, crearem una Docker network, que consisteix en crear una xarxa interna entre contenidors Docker. Abans de muntar els contenidors, crearem la Docker Network, de manera que, la comanda, i la seva sortida, es veuran de la seg\u00fcent manera: El nom de la nostra xarxa \u00e9s moodle, i a la sortida de la comanda podem veure l\u2019ID de la xarxa creada. Amb la xarxa docker creada, procedim a muntar la base de dades: Primerament, llistem les imatges dels contenidors que ens hem baixat anteriorment. Quan tenim la imatge MariaDB localitzada, procedim a executar el container. Amb el par\u00e0metre --name indiquem el nom que li volem donar al contenidor, i amb -eMARIADB_ROOT_PASSWORD indiquem la contrasenya per l\u2019usuari root de la base de dades. Per connectar el contenidor a la xarxa docker creada anteriorment, utilitzem el par\u00e0metre --network=moodle. Pels contenidor PhpMyAdmin i Moodle seguirem el mateix procediment: Contenidor PhpMyAdmin: Contenidor Moodle: Pel que fa al contenidor moodle, no ens hem de preocupar per l\u2019error mostrat a la l\u00ednia final, ja que nom\u00e9s ens informa de que no s\u2019ha pogut connectar a la base de dades. La connexi\u00f3 entre el moodle i la base de dades la farem m\u00e9s endavant. Si llistem els contenidors que s\u2019estan executant, veiem que els tres components estan en marxa: Amb els tres contenidors en funcionament, entrarem a la shell del contenidor mariadb per crear un usuari administrador amb el qual accedirem al phpmyadmin. Per fer-ho, executarem la comanda seg\u00fcent: El nombre donat a continuaci\u00f3 del par\u00e0metre -it es correspon amb l\u2019ID del contenidor mariadb. Per crear l\u2019usuari, entrarem al mariadb: Amb CREATE USER hem creat l\u2019usuari, i amb GRANT ALL PRIVILEGES , hem assignat tots els privilegis a l\u2019usuari creat. Si accedim a un web browser i naveguem al nostre loalchost, veiem que podem comen\u00e7ar la instal\u00b7laci\u00f3 de l\u2019aula virtual. Acabada la instal\u00b7laci\u00f3, podem observar l\u2019aspecte del nostre Moodle: Posteriorment a la instal\u00b7laci\u00f3, hem creat un curs i un usuari professor per administrar el curs. Creaci\u00f3 de certificats per a HTTPS Creaci\u00f3 certificat apache moodle: Un cop tenim una clau rsa dins un arxiu per al moodle podem signar qualsevol arxiu per a certificar l\u2019encriptaci\u00f3 de les dades. Signem el certificat apache moodle: Habilitem el m\u00f2dul ssl d\u2019apache: Afegim les rutes cap al certificat SSL en l\u2019arxiu de configuraci\u00f3 d\u2019Apache:","title":"Aula Virtual"},{"location":"avirtual/#installacio-de-laula-virtual-i-els-contenidors-corresponents","text":"Per instal\u00b7lar el moodle, \u00e9s necessari comptar amb una base de dades, i tamb\u00e9, per agilitzar l\u2019administraci\u00f3, un entorn gr\u00e0fic de gesti\u00f3 com PhpMyAdmin. El programari requerit l\u2019instal\u00b7larem en contenidors mitjan\u00e7ant Docker. Cada component (Moodle, MariaDB i PhpMyAdmin) anir\u00e0 dins d\u2019un contenidor diferent. Perqu\u00e8 els contenidors es puguin comunicar entre ells, crearem una Docker network, que consisteix en crear una xarxa interna entre contenidors Docker. Abans de muntar els contenidors, crearem la Docker Network, de manera que, la comanda, i la seva sortida, es veuran de la seg\u00fcent manera: El nom de la nostra xarxa \u00e9s moodle, i a la sortida de la comanda podem veure l\u2019ID de la xarxa creada. Amb la xarxa docker creada, procedim a muntar la base de dades: Primerament, llistem les imatges dels contenidors que ens hem baixat anteriorment. Quan tenim la imatge MariaDB localitzada, procedim a executar el container. Amb el par\u00e0metre --name indiquem el nom que li volem donar al contenidor, i amb -eMARIADB_ROOT_PASSWORD indiquem la contrasenya per l\u2019usuari root de la base de dades. Per connectar el contenidor a la xarxa docker creada anteriorment, utilitzem el par\u00e0metre --network=moodle. Pels contenidor PhpMyAdmin i Moodle seguirem el mateix procediment: Contenidor PhpMyAdmin: Contenidor Moodle: Pel que fa al contenidor moodle, no ens hem de preocupar per l\u2019error mostrat a la l\u00ednia final, ja que nom\u00e9s ens informa de que no s\u2019ha pogut connectar a la base de dades. La connexi\u00f3 entre el moodle i la base de dades la farem m\u00e9s endavant. Si llistem els contenidors que s\u2019estan executant, veiem que els tres components estan en marxa: Amb els tres contenidors en funcionament, entrarem a la shell del contenidor mariadb per crear un usuari administrador amb el qual accedirem al phpmyadmin. Per fer-ho, executarem la comanda seg\u00fcent: El nombre donat a continuaci\u00f3 del par\u00e0metre -it es correspon amb l\u2019ID del contenidor mariadb. Per crear l\u2019usuari, entrarem al mariadb: Amb CREATE USER hem creat l\u2019usuari, i amb GRANT ALL PRIVILEGES , hem assignat tots els privilegis a l\u2019usuari creat. Si accedim a un web browser i naveguem al nostre loalchost, veiem que podem comen\u00e7ar la instal\u00b7laci\u00f3 de l\u2019aula virtual. Acabada la instal\u00b7laci\u00f3, podem observar l\u2019aspecte del nostre Moodle: Posteriorment a la instal\u00b7laci\u00f3, hem creat un curs i un usuari professor per administrar el curs.","title":"Instal\u00b7laci\u00f3 de l\u2019aula virtual i els contenidors corresponents"},{"location":"avirtual/#creacio-de-certificats-per-a-https","text":"Creaci\u00f3 certificat apache moodle: Un cop tenim una clau rsa dins un arxiu per al moodle podem signar qualsevol arxiu per a certificar l\u2019encriptaci\u00f3 de les dades. Signem el certificat apache moodle: Habilitem el m\u00f2dul ssl d\u2019apache: Afegim les rutes cap al certificat SSL en l\u2019arxiu de configuraci\u00f3 d\u2019Apache:","title":"Creaci\u00f3 de certificats per a HTTPS"},{"location":"conclusio/","text":"Conclusi\u00f3 En conclusi\u00f3, en aquest projecte hem apr\u00e9s l'importancia de tenir les nostres propies infraestructures de xarxa per emmagatzemar les nostres dades i serveis i no dependre d'empreses externes. Tamb\u00e9 hem realitzat tot amb programaris de software lliure i gratuit i realitzat pressupostos per a crear tota l'infrastructura amb recursos reals dins una instituci\u00f3 p\u00fablica com un institut. Bibliograf\u00eda Router Pfsense: https://docs.netgate.com/pfsense/en/latest/routing/static.html Firewall Pfsense: https://www.pfsense.org/download/?section=downloads DNS Pfsense: https://www.youtube.com/watch?v=2g0VoMrJA5c Google Classroom vs Moodle: https://www.ccma.cat/324/moodle-o-google-classroom-acord-deducacio-i-xnet-per-la-digitalitzacio-de-les-aules/noticia/3019411/ Guia ElasticSearch, Kibana, Logstash: https://logz.io/learn/complete-guide-elk-stack/#elasticsearch Trello: https://trello.com/invite/b/86eQ9YW8/ATTI19b81066d6fd403014b685c5b76975f6E0B17DA1/projecte2asix2marcalbert","title":"Conclusi\u00f3"},{"location":"conclusio/#conclusio","text":"En conclusi\u00f3, en aquest projecte hem apr\u00e9s l'importancia de tenir les nostres propies infraestructures de xarxa per emmagatzemar les nostres dades i serveis i no dependre d'empreses externes. Tamb\u00e9 hem realitzat tot amb programaris de software lliure i gratuit i realitzat pressupostos per a crear tota l'infrastructura amb recursos reals dins una instituci\u00f3 p\u00fablica com un institut.","title":"Conclusi\u00f3"},{"location":"conclusio/#bibliografia","text":"Router Pfsense: https://docs.netgate.com/pfsense/en/latest/routing/static.html Firewall Pfsense: https://www.pfsense.org/download/?section=downloads DNS Pfsense: https://www.youtube.com/watch?v=2g0VoMrJA5c Google Classroom vs Moodle: https://www.ccma.cat/324/moodle-o-google-classroom-acord-deducacio-i-xnet-per-la-digitalitzacio-de-les-aules/noticia/3019411/ Guia ElasticSearch, Kibana, Logstash: https://logz.io/learn/complete-guide-elk-stack/#elasticsearch Trello: https://trello.com/invite/b/86eQ9YW8/ATTI19b81066d6fd403014b685c5b76975f6E0B17DA1/projecte2asix2marcalbert","title":"Bibliograf\u00eda"},{"location":"firewall/","text":"Firewall i servei DNS: Programari utilitzat: La m\u00e0quina Firewall tindr\u00e0 instal\u00b7lat el software de codi obert Pfsense, amb aquest gestionarem les normes d\u2019entrada i sortida de paquets per tenir controlat que pot i que no pot entrar o sortir de la m\u00e0quina. Aquest programari tamb\u00e9 ens permet configurar un servidor DNS, d\u2019aquesta forma podriem fer que una m\u00e0quina virtual client utilitzant la m\u00e0quina del firewall com a servidor DNS pugui arribar al moodle del nostre institut resolent el nom de domini en comptes de la IP. Configuraci\u00f3 d\u2019interf\u00edcies: Xarxa WAN - Adaptador Pont: 172.22.9.250/24 Xarxa LAN - Adaptador xarxa interna: 192.168.1.20/24 Administraci\u00f3 gr\u00e0fica del servei amb Pfsense: Configuraci\u00f3 DNS amb Pfsense: Hem implementat una redirecci\u00f3 DNS amb el programari Pfsense per aix\u00ed fer que tots els ordinadors que obtinguin la IP 192.168.1.20 com a servidor DNS tinguin la possibilitat de redirigir les peticions d\u2019adreces que no tingui el nostre servidor ( Totes menys l\u2019adre\u00e7a del nostre servidor Moodle) als servidors de Cloudflare 1.1.1.1, 1.0.0.1 . \u00c9s molt important el ordre al aplicar les normes del Firewall ja que pot afectar en el rendiment d\u2019aquest, com podem veure en aquesta captura nosaltres hem deixat la norma per defecte d\u2019acceptar qualsevol petici\u00f3 LAN IPv4 i IPv6 al final per no interferir en les opcions m\u00e9s restrictives com la del DNS. Tenim com a mode de DNS que primer intenti resoldre la query amb el nostre servidor i si no \u00e9s possible que ho resolgui amb els servidors de CloudFlare, d\u2019aquesta forma quan registrem el nostre nom de domini a aquest DNS ho resoldr\u00e0 correctament. Aqu\u00ed podem veure que la petici\u00f3 \u00e9s resol correctament enviant la petici\u00f3 als servidors de Cloudflare. Normes del Firewall: \u00c9s important al configurar el Firewall que no deixem les normes per defecte, aquestes deixen que qualsevol cosa que no estigui permesa entri igualment. En el nostre cas hem configurat la normativa per a rebutjar totes les peticions que entrin amb IPv4 i directament bloquejar totes les peticions IPv6 ja que no utilitzarem aquest protocol \u00e9s millor tenir bloquejat l\u2019entrada de les peticions.","title":"Firewall Pfsense"},{"location":"firewall/#firewall-i-servei-dns","text":"","title":"Firewall i servei DNS:"},{"location":"firewall/#programari-utilitzat","text":"La m\u00e0quina Firewall tindr\u00e0 instal\u00b7lat el software de codi obert Pfsense, amb aquest gestionarem les normes d\u2019entrada i sortida de paquets per tenir controlat que pot i que no pot entrar o sortir de la m\u00e0quina. Aquest programari tamb\u00e9 ens permet configurar un servidor DNS, d\u2019aquesta forma podriem fer que una m\u00e0quina virtual client utilitzant la m\u00e0quina del firewall com a servidor DNS pugui arribar al moodle del nostre institut resolent el nom de domini en comptes de la IP.","title":"Programari utilitzat:"},{"location":"firewall/#configuracio-dinterficies","text":"Xarxa WAN - Adaptador Pont: 172.22.9.250/24 Xarxa LAN - Adaptador xarxa interna: 192.168.1.20/24","title":"Configuraci\u00f3 d\u2019interf\u00edcies:"},{"location":"firewall/#administracio-grafica-del-servei-amb-pfsense","text":"","title":"Administraci\u00f3 gr\u00e0fica del servei amb Pfsense:"},{"location":"firewall/#configuracio-dns-amb-pfsense","text":"Hem implementat una redirecci\u00f3 DNS amb el programari Pfsense per aix\u00ed fer que tots els ordinadors que obtinguin la IP 192.168.1.20 com a servidor DNS tinguin la possibilitat de redirigir les peticions d\u2019adreces que no tingui el nostre servidor ( Totes menys l\u2019adre\u00e7a del nostre servidor Moodle) als servidors de Cloudflare 1.1.1.1, 1.0.0.1 . \u00c9s molt important el ordre al aplicar les normes del Firewall ja que pot afectar en el rendiment d\u2019aquest, com podem veure en aquesta captura nosaltres hem deixat la norma per defecte d\u2019acceptar qualsevol petici\u00f3 LAN IPv4 i IPv6 al final per no interferir en les opcions m\u00e9s restrictives com la del DNS. Tenim com a mode de DNS que primer intenti resoldre la query amb el nostre servidor i si no \u00e9s possible que ho resolgui amb els servidors de CloudFlare, d\u2019aquesta forma quan registrem el nostre nom de domini a aquest DNS ho resoldr\u00e0 correctament. Aqu\u00ed podem veure que la petici\u00f3 \u00e9s resol correctament enviant la petici\u00f3 als servidors de Cloudflare.","title":"Configuraci\u00f3 DNS amb Pfsense:"},{"location":"firewall/#normes-del-firewall","text":"\u00c9s important al configurar el Firewall que no deixem les normes per defecte, aquestes deixen que qualsevol cosa que no estigui permesa entri igualment. En el nostre cas hem configurat la normativa per a rebutjar totes les peticions que entrin amb IPv4 i directament bloquejar totes les peticions IPv6 ja que no utilitzarem aquest protocol \u00e9s millor tenir bloquejat l\u2019entrada de les peticions.","title":"Normes del Firewall:"},{"location":"introduccio/","text":"Introducci\u00f3: Aquest projecte est\u00e0 principalment centrat en muntar diversos serveis en un entorn virtual, amb un gran \u00e8mfasis en implementar un seguit d\u2019eines i sistemes de seguretat que ens garanteixin la integritat de les dades. Motivaci\u00f3: La nostra motivaci\u00f3 alhora de fer el projecte \u00e9s aconseguir un aula virtual, que respecti la privacitat dels usuaris, amb la m\u00e0xima seguretat de les dades utilitzant eines de codi obert. D\u2019aquesta forma volem evitar que en centres p\u00fablics s\u2019utilitzin eines d\u2019empreses privades com la G-Suite on hi ha una gran opacitat en el tractament de les dades dels usuaris, en alguns casos fins i tot usuaris menors d\u2019edat. Creiem que la eina Moodle \u00e9s una gran alternativa de codi obert, molt adaptable a les necessitats de cada centre educatiu que a la vegada generaria nous llocs de treball dedicats a la seva gesti\u00f3 i manteniment.","title":"Introducci\u00f3"},{"location":"introduccio/#introduccio","text":"Aquest projecte est\u00e0 principalment centrat en muntar diversos serveis en un entorn virtual, amb un gran \u00e8mfasis en implementar un seguit d\u2019eines i sistemes de seguretat que ens garanteixin la integritat de les dades.","title":"Introducci\u00f3:"},{"location":"introduccio/#motivacio","text":"La nostra motivaci\u00f3 alhora de fer el projecte \u00e9s aconseguir un aula virtual, que respecti la privacitat dels usuaris, amb la m\u00e0xima seguretat de les dades utilitzant eines de codi obert. D\u2019aquesta forma volem evitar que en centres p\u00fablics s\u2019utilitzin eines d\u2019empreses privades com la G-Suite on hi ha una gran opacitat en el tractament de les dades dels usuaris, en alguns casos fins i tot usuaris menors d\u2019edat. Creiem que la eina Moodle \u00e9s una gran alternativa de codi obert, molt adaptable a les necessitats de cada centre educatiu que a la vegada generaria nous llocs de treball dedicats a la seva gesti\u00f3 i manteniment.","title":"Motivaci\u00f3:"},{"location":"objectiu/","text":"Objectiu general del projecte: L\u2019objectiu d\u2019aquest treball ser\u00e0 la creaci\u00f3 d\u2019un entorn d\u2019aula virtual per a una entitat educativa, per\u00f2 amb l\u2019afegit de tenir uns sistemes de seguretat avan\u00e7ada. Dividirem el projecte en 5 parts per a facilitar la gesti\u00f3 del temps i els recursos que necessitem per a completar el nostre objectiu. 1.instal\u00b7laci\u00f3 del software 2.Interconectar el maquinari 3.Comprovar la seguretat a partir de la simulaci\u00f3 d\u2019una bateria d\u2019atacs. 4.Fer les \u00faltimes configuracions per a crear un sistema completament funcional. 5.Migraci\u00f3 dels sistemes virtuals a hardware real. Per a complir aquest objectiu, utilitzarem 3 m\u00e0quines diferents, en la primera tindrem un entorn de d\u2019aula virtual completament funcional, i en les dues restants utilitzarem programari especialitzat en ciberseguretat i administraci\u00f3 de sistemes.","title":"Objectiu"},{"location":"objectiu/#objectiu-general-del-projecte","text":"L\u2019objectiu d\u2019aquest treball ser\u00e0 la creaci\u00f3 d\u2019un entorn d\u2019aula virtual per a una entitat educativa, per\u00f2 amb l\u2019afegit de tenir uns sistemes de seguretat avan\u00e7ada. Dividirem el projecte en 5 parts per a facilitar la gesti\u00f3 del temps i els recursos que necessitem per a completar el nostre objectiu. 1.instal\u00b7laci\u00f3 del software 2.Interconectar el maquinari 3.Comprovar la seguretat a partir de la simulaci\u00f3 d\u2019una bateria d\u2019atacs. 4.Fer les \u00faltimes configuracions per a crear un sistema completament funcional. 5.Migraci\u00f3 dels sistemes virtuals a hardware real. Per a complir aquest objectiu, utilitzarem 3 m\u00e0quines diferents, en la primera tindrem un entorn de d\u2019aula virtual completament funcional, i en les dues restants utilitzarem programari especialitzat en ciberseguretat i administraci\u00f3 de sistemes.","title":"Objectiu general del projecte:"},{"location":"procediment/","text":"Procediment: El procediment que seguirem per crear, configurar i implementar els seg\u00fcents serveis segueixen un ordre on primer ens centrarem en el Moodle i el Firewall de Pfsense i finalment crearem el sistema m\u00e9s complex de tots, que es el SIEM. Un cop tot el sistema estigui implementat farem un seguit de proves per atacar al sistema i comprovar la seva seguretat. Per a realitzar els atacs utilitzarem una s\u00e8rie de programari enfocat a la ciberseguretat i el hacking \u00e8tic. Planificaci\u00f3: Per a la planificaci\u00f3 del projecte estem utilitzant la eina Trello, on cadasc\u00fa t\u00e9 les seves tasques assignades. En aquesta plataforma ens hem organitzat separant les tasques que hem de realitzar en tres columnes diferents, \u201cTo do\u201d per totes les tasques que queden pendents de realitzar, \u201cDoing\u201d per les tasques que estan en proc\u00e9s i per tant estan comen\u00e7ades per\u00f2 no acabades i finalment la columna \u201cDone\u201d per a totes les tasques que ja hem completat. Actualitzaci\u00f3 estat de la planificaci\u00f3 23/04/2023","title":"Procediment"},{"location":"procediment/#procediment","text":"El procediment que seguirem per crear, configurar i implementar els seg\u00fcents serveis segueixen un ordre on primer ens centrarem en el Moodle i el Firewall de Pfsense i finalment crearem el sistema m\u00e9s complex de tots, que es el SIEM. Un cop tot el sistema estigui implementat farem un seguit de proves per atacar al sistema i comprovar la seva seguretat. Per a realitzar els atacs utilitzarem una s\u00e8rie de programari enfocat a la ciberseguretat i el hacking \u00e8tic.","title":"Procediment:"},{"location":"procediment/#planificacio","text":"Per a la planificaci\u00f3 del projecte estem utilitzant la eina Trello, on cadasc\u00fa t\u00e9 les seves tasques assignades. En aquesta plataforma ens hem organitzat separant les tasques que hem de realitzar en tres columnes diferents, \u201cTo do\u201d per totes les tasques que queden pendents de realitzar, \u201cDoing\u201d per les tasques que estan en proc\u00e9s i per tant estan comen\u00e7ades per\u00f2 no acabades i finalment la columna \u201cDone\u201d per a totes les tasques que ja hem completat. Actualitzaci\u00f3 estat de la planificaci\u00f3 23/04/2023","title":"Planificaci\u00f3:"},{"location":"programari/","text":"Procediment i programari utilitzat: En nostre projecte consta de 3 m\u00e0quines virtuals com he mencionat anteriorment, aquestes seran creades amb el programari gratu\u00eft VirtualBox. M\u00e0quina 1: La primera contindra un sistema amb Ubuntu 20.04 que tindr\u00e0 instal\u00b7lat el programari de gesti\u00f3 de contenidors Docker Compose . Dins aquesta primera m\u00e0quina crearem 3 contenidors per a tenir cada servei de l\u2019aula compartimentat de forma que ens facilitaria la expansi\u00f3 del servei, una possible futura implementaci\u00f3 de sistemes d\u2019alta disponibilitat i tamb\u00e9 la f\u00e0cil migraci\u00f3 dels serveis que ens permet una eina com Docker en cas de voler canviar de maquinari en un futur. M\u00e0quina 2: La segona m\u00e0quina ser\u00e0 un firewall amb router incorporat on utilitzarem el programari de codi lliure Pfsense , amb aquest tamb\u00e9 podrem configurar un DNS per si volem resoldre l\u2019adre\u00e7a web del nostre servidor Moodle des d\u2019un client. M\u00e0quina 3: Finalment la tercera m\u00e0quina tindr\u00e0 un sistema SIEM, en aquesta tindrem el ELK Stack, una colecci\u00f3 de software de codi obert produ\u00eft per Elastic, el Elastic Stack te quatre components principals: -ElasticSearch: Motor de cerca i recol\u00b7lecci\u00f3 de dades. -Logstash: Processador de dades dissenyat per enviar dades a ElasticSearch. -FileBeats: Eina dedicada a adquirir i recopilar dades dels sistemes per enviar-les a ElasticSearch. Alhora d\u2019instal\u00b7lar el programari, \u00e9s molt important controlar les versions de cadascun, d\u2019aquesta forma evitem qualsevol tipus d\u2019incompatibilitat entre el software que estem utilitzant, incl\u00f3s el del sistema operatiu.","title":"Programari"},{"location":"programari/#procediment-i-programari-utilitzat","text":"En nostre projecte consta de 3 m\u00e0quines virtuals com he mencionat anteriorment, aquestes seran creades amb el programari gratu\u00eft VirtualBox.","title":"Procediment i programari utilitzat:"},{"location":"programari/#maquina-1","text":"La primera contindra un sistema amb Ubuntu 20.04 que tindr\u00e0 instal\u00b7lat el programari de gesti\u00f3 de contenidors Docker Compose . Dins aquesta primera m\u00e0quina crearem 3 contenidors per a tenir cada servei de l\u2019aula compartimentat de forma que ens facilitaria la expansi\u00f3 del servei, una possible futura implementaci\u00f3 de sistemes d\u2019alta disponibilitat i tamb\u00e9 la f\u00e0cil migraci\u00f3 dels serveis que ens permet una eina com Docker en cas de voler canviar de maquinari en un futur.","title":"M\u00e0quina 1:"},{"location":"programari/#maquina-2","text":"La segona m\u00e0quina ser\u00e0 un firewall amb router incorporat on utilitzarem el programari de codi lliure Pfsense , amb aquest tamb\u00e9 podrem configurar un DNS per si volem resoldre l\u2019adre\u00e7a web del nostre servidor Moodle des d\u2019un client.","title":"M\u00e0quina 2:"},{"location":"programari/#maquina-3","text":"Finalment la tercera m\u00e0quina tindr\u00e0 un sistema SIEM, en aquesta tindrem el ELK Stack, una colecci\u00f3 de software de codi obert produ\u00eft per Elastic, el Elastic Stack te quatre components principals: -ElasticSearch: Motor de cerca i recol\u00b7lecci\u00f3 de dades. -Logstash: Processador de dades dissenyat per enviar dades a ElasticSearch. -FileBeats: Eina dedicada a adquirir i recopilar dades dels sistemes per enviar-les a ElasticSearch. Alhora d\u2019instal\u00b7lar el programari, \u00e9s molt important controlar les versions de cadascun, d\u2019aquesta forma evitem qualsevol tipus d\u2019incompatibilitat entre el software que estem utilitzant, incl\u00f3s el del sistema operatiu.","title":"M\u00e0quina 3:"},{"location":"recursos/","text":"Recursos necessaris: En el nostre cas estem fent una simulaci\u00f3 amb m\u00e0quines virtuals i no reals, per\u00f2 en cas de migrar aquest sistema a un centre educatiu, hauriem de utilitzar gran quantitat de recursos, en aquest apartat detallare els recursos necessaris per a poder instal\u00b7lar de forma funcional en nostre sistema en un centre educatiu. Maquinari: El maquinari escollit ens servir\u00e0 per crear una infraestructura que pugui durar una gran quantitat de temps sense quedar-se obsoleta, amb una capacitat d\u2019expansi\u00f3 suficient en cas de voler realitzar ampliacions en el centre educatiu o voler instal\u00b7lar m\u00e9s serveis dins el maquinari. Equip Preu (\u20ac) Armari Rack 19\" 32U 600x800 (x2) 1.378\u20ac Hpe ProLiant Dl20 Gen10 E-2236/16GB (x2) 3.264\u20ac Equip Patch Panel 24 puertos Cat 5e 35,99\u20ac TP-LINK TL-SG1024 Switch 24 Puertos Gigabit 19\" 119\u20ac FSP Twins PRO Fuente de Alimentaci\u00f3n 700W 531,41\u20ac Easy UPS On-Line SRV 72 V de APC 918,39 \u20ac SAI Easy UPS en l\u00ednea de APC 2.783\u20ac Seagate IronWolf NAS 3TB SATA3 (x6) 744\u20ac TOTAL 9.773,79\u20ac Diners: Per l\u2019elecci\u00f3 del maquinari hem assignat un pressupost de menys de 10.000\u20ac, aquesta inversi\u00f3 est\u00e0 orientada a un maquinari que suporta gran quantitat d\u2019emmagatzematge per a poder guardar durant anys els arxius i recursos que necessiten els alumnes i els docents, i per a assegurar que hi ha espai suficient per emmagatzemar backups. Personal: Necessitar\u00edem com a m\u00ednim per a un centre petit 2 inform\u00e0tics per a configurar el nostre sistema SIEM, junt amb el firewall per a assegurar la seguretat del sistema. Tamb\u00e9 ser\u00e0 necessari que un dels docents s\u2019encarregui de configurar tot el sistema de classes, temari, alumnes, etc\u2026 un cop estigui posat en marxa el Moodle. Manteniment del sistema: Ser\u00eda indispensable que un cop posat en marxa el sistema com a m\u00ednim un dels inform\u00e0tics s\u2019encarregues de fer un manteniment del sistema, on de forma mensual s\u2019actualitzes el programari per evitar fallides de seguretat. Tamb\u00e9 haur\u00edem de tenir un responsable encarregat de gestionar els logs i comprovar peri\u00f2dicament l\u2019estat del sistema. Tamb\u00e9 hem de tenir en compte que el nostre sistema ha d\u2019estar operatiu les 24 hores del dia ja que hem de tenir en compte que el sistema ha d\u2019estar disponible per als alumnes i docents en tot moment. Proves de rendiment: Necessitar\u00edem realitzar proves de rendiment peri\u00f2diques per assegurar que el sistema funciona correctament i per a identificar possibles problemes que afectin la seguretat del centre educatiu. Backups: Necessitarem realitzar de forma peri\u00f2dica c\u00f2pies de seguretat per a prevenir possibles p\u00e8rdues de dades en cas de fallida del sistema. En el nostre cas utilitzarem un script que gestionar\u00e1 el crontab per a executar-se a les 3:00 d\u2019aquesta forma la copia de seguretat no utilitza recursos en un moment on hi hagi tr\u00e0fic al sistema. Amb aquest script podem configurar c\u00f2pies de seguretat que s\u2019emmagatzemen en format .tar.gz a un directori espec\u00edfic per als backups, tamb\u00e9 hem creat aquest script de forma que podem escollir l\u2019origen de la c\u00f2pia, per tant al crontab podem executar el mateix script en moments diferents per a generar c\u00f2pies de seguretat de directoris diferents. En cas de que no funcioni correctament el backup, ens saltara un missatge d\u2019error generat amb la comanda \u201cecho\u201d. #!/bin/bash # Format pel nom de fitxer, basat en la data dels backups FORMAT=$(date+\"%Y-%m-%d_%H-%M-%S\") # Directori del qual volem un backup, # passat com a par\u00e0metre trav\u00e9s de la l\u00ednea de comandes SOURCE=\"$1\" # Destinaci\u00f3 del backup DESTINATION=\"/backups\" # Crear el fitxer amb el format esmentat FILE=\"$DESTINATION/backup_$FORMAT.tar.gz\" # Creaci\u00f3 del fitxer amb la comanda tar tar -czvf $FILE -R $SOURCE # Comprovaci\u00f3 d'errors if [$? -eq 0]; then echo \"Backup Succesful\" else echo \"Backup Failed\" fi Temps: Tot el proc\u00e9s d\u2019instal\u00b7laci\u00f3, configuraci\u00f3 i posada en marxa podria tardar 1 mes aproximadament amb 2 treballadors, per\u00f2 tamb\u00e9 hem de tenir en compte que la sala on instal\u00b7lem els sistemes tingui un cablejat \u00f2ptim per a la connexi\u00f3 a internet, junt amb uns bons sistemes de refrigeraci\u00f3. En cas de no complir les condicions \u00f2ptimes per a la instal\u00b7laci\u00f3 d\u2019uns sistemes com els que proposem farien falta de 2 a 3 mesos depenent l\u2019estat de les instal\u00b7lacions on volem col\u00b7locar el maquinari.","title":"Recursos necessaris"},{"location":"recursos/#recursos-necessaris","text":"En el nostre cas estem fent una simulaci\u00f3 amb m\u00e0quines virtuals i no reals, per\u00f2 en cas de migrar aquest sistema a un centre educatiu, hauriem de utilitzar gran quantitat de recursos, en aquest apartat detallare els recursos necessaris per a poder instal\u00b7lar de forma funcional en nostre sistema en un centre educatiu.","title":"Recursos necessaris:"},{"location":"recursos/#maquinari","text":"El maquinari escollit ens servir\u00e0 per crear una infraestructura que pugui durar una gran quantitat de temps sense quedar-se obsoleta, amb una capacitat d\u2019expansi\u00f3 suficient en cas de voler realitzar ampliacions en el centre educatiu o voler instal\u00b7lar m\u00e9s serveis dins el maquinari. Equip Preu (\u20ac) Armari Rack 19\" 32U 600x800 (x2) 1.378\u20ac Hpe ProLiant Dl20 Gen10 E-2236/16GB (x2) 3.264\u20ac Equip Patch Panel 24 puertos Cat 5e 35,99\u20ac TP-LINK TL-SG1024 Switch 24 Puertos Gigabit 19\" 119\u20ac FSP Twins PRO Fuente de Alimentaci\u00f3n 700W 531,41\u20ac Easy UPS On-Line SRV 72 V de APC 918,39 \u20ac SAI Easy UPS en l\u00ednea de APC 2.783\u20ac Seagate IronWolf NAS 3TB SATA3 (x6) 744\u20ac TOTAL 9.773,79\u20ac","title":"Maquinari:"},{"location":"recursos/#diners","text":"Per l\u2019elecci\u00f3 del maquinari hem assignat un pressupost de menys de 10.000\u20ac, aquesta inversi\u00f3 est\u00e0 orientada a un maquinari que suporta gran quantitat d\u2019emmagatzematge per a poder guardar durant anys els arxius i recursos que necessiten els alumnes i els docents, i per a assegurar que hi ha espai suficient per emmagatzemar backups.","title":"Diners:"},{"location":"recursos/#personal","text":"Necessitar\u00edem com a m\u00ednim per a un centre petit 2 inform\u00e0tics per a configurar el nostre sistema SIEM, junt amb el firewall per a assegurar la seguretat del sistema. Tamb\u00e9 ser\u00e0 necessari que un dels docents s\u2019encarregui de configurar tot el sistema de classes, temari, alumnes, etc\u2026 un cop estigui posat en marxa el Moodle.","title":"Personal:"},{"location":"recursos/#manteniment-del-sistema","text":"Ser\u00eda indispensable que un cop posat en marxa el sistema com a m\u00ednim un dels inform\u00e0tics s\u2019encarregues de fer un manteniment del sistema, on de forma mensual s\u2019actualitzes el programari per evitar fallides de seguretat. Tamb\u00e9 haur\u00edem de tenir un responsable encarregat de gestionar els logs i comprovar peri\u00f2dicament l\u2019estat del sistema. Tamb\u00e9 hem de tenir en compte que el nostre sistema ha d\u2019estar operatiu les 24 hores del dia ja que hem de tenir en compte que el sistema ha d\u2019estar disponible per als alumnes i docents en tot moment. Proves de rendiment: Necessitar\u00edem realitzar proves de rendiment peri\u00f2diques per assegurar que el sistema funciona correctament i per a identificar possibles problemes que afectin la seguretat del centre educatiu. Backups: Necessitarem realitzar de forma peri\u00f2dica c\u00f2pies de seguretat per a prevenir possibles p\u00e8rdues de dades en cas de fallida del sistema. En el nostre cas utilitzarem un script que gestionar\u00e1 el crontab per a executar-se a les 3:00 d\u2019aquesta forma la copia de seguretat no utilitza recursos en un moment on hi hagi tr\u00e0fic al sistema. Amb aquest script podem configurar c\u00f2pies de seguretat que s\u2019emmagatzemen en format .tar.gz a un directori espec\u00edfic per als backups, tamb\u00e9 hem creat aquest script de forma que podem escollir l\u2019origen de la c\u00f2pia, per tant al crontab podem executar el mateix script en moments diferents per a generar c\u00f2pies de seguretat de directoris diferents. En cas de que no funcioni correctament el backup, ens saltara un missatge d\u2019error generat amb la comanda \u201cecho\u201d. #!/bin/bash # Format pel nom de fitxer, basat en la data dels backups FORMAT=$(date+\"%Y-%m-%d_%H-%M-%S\") # Directori del qual volem un backup, # passat com a par\u00e0metre trav\u00e9s de la l\u00ednea de comandes SOURCE=\"$1\" # Destinaci\u00f3 del backup DESTINATION=\"/backups\" # Crear el fitxer amb el format esmentat FILE=\"$DESTINATION/backup_$FORMAT.tar.gz\" # Creaci\u00f3 del fitxer amb la comanda tar tar -czvf $FILE -R $SOURCE # Comprovaci\u00f3 d'errors if [$? -eq 0]; then echo \"Backup Succesful\" else echo \"Backup Failed\" fi","title":"Manteniment del sistema:"},{"location":"recursos/#temps","text":"Tot el proc\u00e9s d\u2019instal\u00b7laci\u00f3, configuraci\u00f3 i posada en marxa podria tardar 1 mes aproximadament amb 2 treballadors, per\u00f2 tamb\u00e9 hem de tenir en compte que la sala on instal\u00b7lem els sistemes tingui un cablejat \u00f2ptim per a la connexi\u00f3 a internet, junt amb uns bons sistemes de refrigeraci\u00f3. En cas de no complir les condicions \u00f2ptimes per a la instal\u00b7laci\u00f3 d\u2019uns sistemes com els que proposem farien falta de 2 a 3 mesos depenent l\u2019estat de les instal\u00b7lacions on volem col\u00b7locar el maquinari.","title":"Temps:"},{"location":"siem/","text":"Instal\u00b7laci\u00f3 i configuraci\u00f3 del SIEM Per procurar una instal\u00b7laci\u00f3 correcte del SIEM, i per tant, un funcionament adient, ens calen quatre eines: Elasticsearch, Kibana, Logstash i Filebeat. Comen\u00e7arem la instal\u00b7laci\u00f3 del SIEM configurant l\u2019Elasticsearch: El primer pas \u00e9s instal\u00b7lar l\u2019Elasticsearch, per tant afegirem el repositori: root@siem:# curl -fsSL https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo gpg --dearmor -o /usr/share/keyrings/elastic.gpg Acte seguit, l\u2019instal\u00b7lem: Mitjan\u00e7ant l\u2019editor nano, modifiquem les seg\u00fcent l\u00ednies de l\u2019arxiu de configuraci\u00f3 elasticsearch.yml : Seguits els passos anteriors, podem comen\u00e7ar a instal\u00b7lar la seg\u00fcent eina, el Kibana: -Instal\u00b7lem Kibana: -Generem una contrasenya per l\u2019usuari kibanaadmin i la guardem al directori htpasswd.users: -Mitjan\u00e7ant el web browsers entrem al Kibana: Amb el Kibana instal\u00b7lat, procedim a instal\u00b7lar la pen\u00faltima eina, el Logstash: -Amb apt install instal\u00b7lem el Logstash: -Creem i editem els arxius que redirigiran i filtraran el tr\u00e0fic pel port 5044 i 9200 que ens servir\u00e0 pel Filebeat: Amb els filtres del Logstash creats, procedim a l\u2019\u00faltim pas, instal\u00b7lar el Filebeat: -El primer pas \u00e9s instal\u00b7lar el filebeat: -Editem l\u2019arxiu de configuraci\u00f3 filebeat.yml comentant les l\u00ednies output.elasticsearch i hosts: -Descomentem les seg\u00fcents l\u00ednies: -Habilitem els pipelines del logsearch: Finalment per a que logstash rebi els logs de kibana haurem de crear un host d\u2019entrada, i un host de sortida. Editem l\u2019arxiu /etc/filebeat/filebeat.yml : -Afegim el host de Kibana (que \u00e9s el SIEM): -Afegim la sortida del Logstash (que \u00e9s el SIEM): Aqu\u00ed tenim una comprovaci\u00f3 de com el Kibana mostra els logs que ha rebut Logstash del nostre apache instal\u00b7lat a la m\u00e0quina Moodle.","title":"Configuraci\u00f3 SIEM"},{"location":"siem/#installacio-i-configuracio-del-siem","text":"Per procurar una instal\u00b7laci\u00f3 correcte del SIEM, i per tant, un funcionament adient, ens calen quatre eines: Elasticsearch, Kibana, Logstash i Filebeat. Comen\u00e7arem la instal\u00b7laci\u00f3 del SIEM configurant l\u2019Elasticsearch: El primer pas \u00e9s instal\u00b7lar l\u2019Elasticsearch, per tant afegirem el repositori: root@siem:# curl -fsSL https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo gpg --dearmor -o /usr/share/keyrings/elastic.gpg Acte seguit, l\u2019instal\u00b7lem: Mitjan\u00e7ant l\u2019editor nano, modifiquem les seg\u00fcent l\u00ednies de l\u2019arxiu de configuraci\u00f3 elasticsearch.yml : Seguits els passos anteriors, podem comen\u00e7ar a instal\u00b7lar la seg\u00fcent eina, el Kibana: -Instal\u00b7lem Kibana: -Generem una contrasenya per l\u2019usuari kibanaadmin i la guardem al directori htpasswd.users: -Mitjan\u00e7ant el web browsers entrem al Kibana: Amb el Kibana instal\u00b7lat, procedim a instal\u00b7lar la pen\u00faltima eina, el Logstash: -Amb apt install instal\u00b7lem el Logstash: -Creem i editem els arxius que redirigiran i filtraran el tr\u00e0fic pel port 5044 i 9200 que ens servir\u00e0 pel Filebeat: Amb els filtres del Logstash creats, procedim a l\u2019\u00faltim pas, instal\u00b7lar el Filebeat: -El primer pas \u00e9s instal\u00b7lar el filebeat: -Editem l\u2019arxiu de configuraci\u00f3 filebeat.yml comentant les l\u00ednies output.elasticsearch i hosts: -Descomentem les seg\u00fcents l\u00ednies: -Habilitem els pipelines del logsearch: Finalment per a que logstash rebi els logs de kibana haurem de crear un host d\u2019entrada, i un host de sortida. Editem l\u2019arxiu /etc/filebeat/filebeat.yml : -Afegim el host de Kibana (que \u00e9s el SIEM): -Afegim la sortida del Logstash (que \u00e9s el SIEM): Aqu\u00ed tenim una comprovaci\u00f3 de com el Kibana mostra els logs que ha rebut Logstash del nostre apache instal\u00b7lat a la m\u00e0quina Moodle.","title":"Instal\u00b7laci\u00f3 i configuraci\u00f3 del SIEM"},{"location":"xarxa/","text":"Esquema de xarxa: Com ja s\u2019ha esmentat anteriorment, utilitzarem tres m\u00e0quines interconnectades en la mateixa xarxa, la primera un Ubuntu que tindr\u00e0 3 contenidors de docker, entre ells el moodle, la segona sera el nostre SIEM amb el ELK stack, i la tercera, que tindr\u00e0 connexi\u00f3 amb la xarxa de l\u2019escola es un maquinari amb pfsense instal\u00b7lat per actuar com a firewall i router.","title":"Esquema de xarxa"},{"location":"xarxa/#esquema-de-xarxa","text":"Com ja s\u2019ha esmentat anteriorment, utilitzarem tres m\u00e0quines interconnectades en la mateixa xarxa, la primera un Ubuntu que tindr\u00e0 3 contenidors de docker, entre ells el moodle, la segona sera el nostre SIEM amb el ELK stack, i la tercera, que tindr\u00e0 connexi\u00f3 amb la xarxa de l\u2019escola es un maquinari amb pfsense instal\u00b7lat per actuar com a firewall i router.","title":"Esquema de xarxa:"}]}